<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Permissions-Policy" content="autoplay=*, encrypted-media=*">
    <link rel="icon" href="numberblocks-logo.png" type="image/png">
    <title>NumberBlocks Episodes</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css?v=1.0.5">
    <script src="https://www.youtube.com/iframe_api"></script>
</head>
<body>

<!-- 사이드 메뉴 Start -->
<nav class="side-nav" aria-label="시리즈 선택">
    <ul>
        <li><button class="series-btn" data-series="numberblocks" aria-label="NumberBlocks 시리즈 보기">
            <img src="numberblocks-logo.png" alt="NumberBlocks 로고" class="side-logo" />
        </button></li>
        <li><button class="series-btn" data-series="peppapig" aria-label="Peppa Pig 시리즈 보기">
            <img src="peppa-pig-logo.jpg" alt="Peppa Pig 로고" class="side-logo" />
        </button></li>
    </ul>
</nav>
<!-- 사이드 메뉴 End -->

<div class="main-content" id="main-content">
    <div id="numberblocks-section">
        <!-- 탭 버튼 Start -->
        <div class="tab">
            <button class="tab-links" onclick="openTab(event, 'Episodes1to10')" id="defaultOpen">1-10 Episodes</button>
            <button class="tab-links" onclick="openTab(event, 'TheRestOfLevel1')">Level 1</button>
            <button class="tab-links" onclick="openTab(event, 'TheRestOfLevel2')">Level 2</button>
            <button class="tab-links" onclick="openTab(event, 'Episodes11to100')">11-100 Episodes</button>
            <button class="tab-links" onclick="openTab(event, 'SpecialAdventures')">🌟</button>
            
        </div>
        <!-- 탭 버튼 End -->
        <!-- 탭 별 카드 Start -->
        <div id="Episodes1to10" class="tab-content">
            <div class="grid-container" id="grid-1to10"></div>
        </div>
        <div id="TheRestOfLevel1" class="tab-content">
            <div class="grid-container" id="grid-level1"></div>
        </div>
        <div id="TheRestOfLevel2" class="tab-content">
            <div class="grid-container" id="grid-level2"></div>
        </div>
        <div id="Episodes11to100" class="tab-content">
            <div class="grid-container" id="grid-11to100"></div>
        </div>
        <div id="SpecialAdventures" class="tab-content">
            <div class="grid-container" id="grid-special-adventures"></div>
        </div>
        <footer class="site-footer">
            Based on <a href="https://www.learningblocks.tv/numberblocks/episodes" target="_blank" rel="noopener noreferrer">
            NumberBlocks official page</a>
        </footer>
        
    </div>
    <div id="peppa-section" style="display:none;">
        <div class="tab">
            <button class="tab-links active" onclick="openTab(event, 'PeppaSeason1')" id="peppaDefaultOpen">Season 1</button>
        </div>
        <div id="PeppaSeason1" class="tab-content" style="display:block;">
            <div class="grid-container" id="grid-peppa1"></div>
        </div>
        <footer class="site-footer">
            Based on 
            <a href="https://www.youtube.com/@PeppaPigOfficial" target="_blank" rel="noopener noreferrer">Peppa Pig Official page</a> and
            <a href="https://www.youtube.com/@George Pig" target="_blank" rel="noopener noreferrer">George Pig page</a>
        </footer>
    </div>
</div>

<script>
// 스마트 캐시 관리 스크립트
(function() {
    const CURRENT_VERSION = '1.0.5';
    const STORAGE_KEY = 'numberblocks_version';
    
    // 저장된 버전 확인
    function getStoredVersion() {
        try {
            return localStorage.getItem(STORAGE_KEY);
        } catch (e) {
            return null;
        }
    }
    
    // 버전 저장
    function setStoredVersion(version) {
        try {
            localStorage.setItem(STORAGE_KEY, version);
        } catch (e) {
            // localStorage 사용 불가능한 경우 무시
        }
    }
    
    // 버전이 변경되었는지 확인
    function isVersionChanged() {
        const storedVersion = getStoredVersion();
        return storedVersion !== CURRENT_VERSION;
    }
    
    // 캐시 무효화가 필요한 경우에만 새로고침
    function checkAndReload() {
        if (isVersionChanged()) {
            console.log('버전이 변경되어 캐시를 무효화합니다:', getStoredVersion(), '->', CURRENT_VERSION);
            setStoredVersion(CURRENT_VERSION);
            
            // iOS Safari 특별 처리
            if (/iPad|iPhone|iPod/.test(navigator.userAgent)) {
                window.addEventListener('pageshow', function(event) {
                    if (event.persisted) {
                        window.location.reload();
                    }
                });
            }
            
            // 뒤로가기로 접근한 경우에만 새로고침
            if (window.performance && window.performance.navigation.type === window.performance.navigation.TYPE_BACK_FORWARD) {
                window.location.reload(true);
            }
        } else {
            console.log('현재 버전이 최신입니다:', CURRENT_VERSION);
        }
    }
    
    // 페이지 로드 시 버전 체크
    checkAndReload();
})();
</script>
<script src="assets/js/episode-data.js?v=1.0.5"></script>
<script src="assets/js/common.js?v=1.0.5"></script>
<script src="assets/js/iframe-mode.js?v=1.0.5"></script>

</body>
</html>
